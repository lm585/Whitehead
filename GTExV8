linyong@tak ~$ h | grep pfb
  540  pfb
  543  pip install pypfb==0.5.0
  544  pfb
  546  /home/linyong/.local/bin/pfb
  551  # pfb to -i <PATH_to_export_pfb.avro> tsv
  552  pfb to -i  export_2023-01-26T20.avro tsv
  553  /home/linyong/.local/bin/pfb to -i  export_2023-01-26T20.avro tsv
  563  #/home/linyong/.local/bin/pfb to -i  export_2023-01-26T20.avro tsv
  564  /home/linyong/.local/bin/pfb to -i export_2023-01-26T20\ 39\ 38.avro tsv
  578  /home/linyong/.local/bin/pfb to -i "export_2023-01-26T21 12 10.avro" tsv
##from tak cluster only
/home/linyong/.local/bin/pfb to -i "export_2023-01-26T21 12 10.avro" tsv
-rw-r--r-- 1 linyong input 22M Jan 26 16:18 export_2023-01-26T21 12 10.avro


./gen3-client |not exec this cmd### configure --profile=gtexv8 --cred=credentials.json --apiendpoint=https://gen3.theanvil.io
# 2023/01/27 15:22:22 Profile 'gtexv8' has been configured successfully.
./gen3-client configure --profile=gtexv8expire_3_29  --cred=credentials_expire_3_29.json --apiendpoint=https://gen3.theanvil.io
2023/02/27 12:27:17 A new version of gen3-client is available! The latest version is 2023.2.0. You are using version 2022.12
2023/02/27 12:27:17 Please download the latest gen3-client release from https://github.com/uc-cdis/cdis-data-client/releases/latest
2023/02/27 12:27:17 Profile 'gtexv8expire_3_29' has been configured successfully.

linyong@tak /lab/solexa_page/linyong$ /lab/page_human_data/linyong2/dir-gtex-118/gen3-client  configure --profile=gtexv8expire_4_26 --cred=credentials_expire_4_26.json  --apiendpoint=https://gen3.theanvil.io
2023/03/27 16:32:08 A new version of gen3-client is available! The latest version is 2023.4.0. You are using version 2022.12
2023/03/27 16:32:08 Please download the latest gen3-client release from https://github.com/uc-cdis/cdis-data-client/releases/latest
2023/03/27 16:32:08 Profile 'gtexv8expire_4_26' has been configured successfully.

linyong@fry /lab/solexa_page/linyong$ /lab/page_human_data/linyong2/dir-gtex-118/gen3-client  configure --profile=gtexv8expire_5_26 --cred=credentials-5-26-5pm.json  --apiendpoint=https://gen3.theanvil.io 
2023/04/26 17:36:24 A new version of gen3-client is available! The latest version is 2023.4.0. You are using version 2022.12
2023/04/26 17:36:24 Please download the latest gen3-client release from https://github.com/uc-cdis/cdis-data-client/releases/latest
2023/04/26 17:36:24 Profile 'gtexv8expire_5_26' has been configured successfully.

linyong@fry /lab/solexa_page/linyong$ /lab/page_human_data/linyong2/dir-gtex-118/gen3-client  configure --profile=gtexv8expire_5_26 --cred=credentials_6_26.json  --apiendpoint=https://gen3.theanvil.io 
2023/05/27 15:31:01 A new version of gen3-client is available! The latest version is 2023.6.0. You are using version 2022.12
2023/05/27 15:31:01 Please download the latest gen3-client release from https://github.com/uc-cdis/cdis-data-client/releases/latest
2023/05/27 15:31:01 Profile 'gtexv8expire_5_26' has been configured successfully.

    Important: “--protocol” tag is important to this command as it will determine which bucket the files will be downloaded from. The “s3” value will download from the egress free Cleversafe bucket for the datasets in the “Downloadable” tab.

    Note: With larger manifests containing more than 100,000 files such as GTEx v8, the initial process of reading and parsing the manifest into the gen3-client can take anywhere from 30 - 240 mins.

cp -i  file-manifest.json file-manifest.test.json
vi file-manifest.test.json

./gen3-client download-multiple --profile=gtexv8  --manifest=file-manifest.test.json --download-path=dir-gtexv8-bam-files --protocol=s3
#
2023/01/27 15:36:19 A new version of gen3-client is available! The latest version is 2023.2.0. You are using version 2022.12
2023/01/27 15:36:19 Please download the latest gen3-client release from https://github.com/uc-cdis/cdis-data-client/releases/latest
2023/01/27 15:36:19 Reading manifest...
 1.86 KiB / 1.86 KiB [===========================================================================================] 100.00% 0s
WARNING: flag "rename" was set to false in "original" mode, duplicated files under "dir-gtexv8-bam-files/" will be overwritten
Proceed? [y/n]: y
2023/01/27 15:36:42 Total number of objects in manifest: 8
2023/01/27 15:36:42 Preparing file info for each file, please wait...
 8 / 8 [=========================================================================================================] 100.00% 0s
2023/01/27 15:36:42 File info prepared successfully  
GTEX-1CB4F-2326-SM-7MKFO.Aligned.sortedByCoord.out.patched.md.bam  4.77 GiB / 4.77 GiB [============================] 100.00%
GTEX-1GMRU-0011-R5a-SM-CKZNS.Aligned.sortedByCoord.out.patched.md.bam  4.83 GiB / 4.83 GiB [========================] 100.00%
GTEX-1I1CD-1226-SM-CNPQ2.Aligned.sortedByCoord.out.patched.md.bam  4.77 GiB / 4.77 GiB [============================] 100.00%
GTEX-S341-0008-SM-4AD6D.Aligned.sortedByCoord.out.patched.md.bam  4.79 GiB / 4.79 GiB [=============================] 100.00%
GTEX-RM2N-1426-SM-2TF4H.Aligned.sortedByCoord.out.patched.md.bam  6.45 GiB / 6.45 GiB [=============================] 100.00%
GTEX-1HCVE-1026-SM-ACKXR.Aligned.sortedByCoord.out.patched.md.bam  5.15 GiB / 5.15 GiB [============================] 100.00%
GTEX-1GN2E-1526-SM-7P8TD.Aligned.sortedByCoord.out.patched.md.bam  4.55 GiB / 4.55 GiB [============================] 100.00%
GTEX-17JCI-1526-SM-7IGOQ.Aligned.sortedByCoord.out.patched.md.bam  2.29 GiB / 2.29 GiB [============================] 100.00%
2023/01/27 15:43:44 8 files downloaded.

/lab/page_human_data/linyong2/dir-gtex-118/gen3-client download-multiple --profile=gtexv8expire_3_29  --manifest=temp.json --protocol=s3 --no-prompt  

##############################rm _PAR_Y lines from gtf
sort gencode.v42.primary_assembly.annotation.gtf | uniq -d | wc -l
0
cat gencode.v42.primary_assembly.annotation.gtf | grep -iw "transcript" | wc -l
252475
cat rsemindex_gencode_01.ti | grep ENST | awk 'NF == 2' | wc -l
252475
cat rsemindex_gencode_01.ti | grep ENST | awk 'NF == 2' | cut -f 1 | sort | uniq -d | wc -l
0
cat rsemindex_gencode_01.ti | grep ENST | awk 'NF == 2' | cut -f 1 | sed 's/_PAR_Y//' | sort | uniq -d | wc -l
174
cat gencode.v42.primary_assembly.annotation.gtf | grep PAR_Y | cut -f 3 | sort |uniq -c
    450 CDS
    937 exon
     47 gene
     71 start_codon
     58 stop_codon
    174 transcript
    214 UTR
450 + 937 + 47 + 71 + 58 + 174 + 214
[1] 1951
cat gencode.v42.primary_assembly.annotation.gtf | grep "_PAR_Y\"; " > temp-1
wc -l temp-1
1951 temp-1
cat temp-1 | grep "tag \"PAR\";" | wc -l
1951
grep -v "_PAR_Y\"; " gencode.v42.primary_assembly.annotation.gtf > gencode.v42.primary_assembly.noPar.annotation.gtf
grep -i "par.y" gencode.v42.primary_assembly.noPar.annotation.gtf | wc -l
0
diff gencode.v42.primary_assembly.annotation.gtf  gencode/gencode.v42.primary_assembly.annotation.gtf | wc
      0       0       0
(from helen) -r-xr-xr-x 1 linyong input 1561033529 Jan 13 20:43 gencode/gencode.v42.primary_assembly.annotation.gtf*
(download  ) -rw-r--r-- 1 linyong input 1561033529 Feb  2 14:01 gencode.v42.primary_assembly.annotation.gtf

##################

java -jar /usr/local/share/picard-tools/picard.jar SamToFastq I=GTEX-RM2N-1426-SM-2TF4H.Aligned.sortedByCoord.out.patched.md.bam FASTQ="r3.fq" SECOND_END_FASTQ="r4.fq"

[Thu Feb 02 14:45:09 EST 2023] picard.sam.SamToFastq done. Elapsed time: 14.32 minutes.
Runtime.totalMemory()=2,016,411,648

  196335196 r3.fq (49083799 read pairs)
  196335196 r4.fq
  392670392 total
awk 'NR % 4 == 1'  r3.fq | sort | uniq -d | wc
(no dup read)      0       0       0
/lab/solexa_page/linyong/dir-gtexv8-bam-files$ awk 'NR % 4 == 1'  r3.fq | sort | uniq -u | wc -l
49083799

##########################
cat slurm-wi-star-genome-index
#!/bin/bash
# Configuration values for SLURM job submission.
# One leading hash ahead of the word SBATCH is not a comment, but two are.
#SBATCH --job-name="satrgenomeindex" # friendly name for job.
#SBATCH --nodes=1                      # ensure cores are on one node
#SBATCH --ntasks=1                     # run a single task
#SBATCH --cpus-per-task=20              # number of cores/threads requested.
#SBATCH --mem=128gb                      # memory requested.
#SBATCH --partition=20                 # partition (queue) to use
#SBATCH --output star-genome-index-%j.out   # name of output file.  %j is jobid
##SBATCH --mail-type=ALL               # send email on job start/finish.
##SBATCH --mail-user=linyong@wi.mit.edu

# This is the actual section for commands to run
STAR  --runMode genomeGenerate  --genomeDir /lab/solexa_page/linyong/dir-star-genome-index-oh75  --genomeFastaFiles   /lab/solexa_page/linyong/gencode/GRCh38.primary_assembly.genome.fa    --sjdbGTFfile  /lab/solexa_page/linyong/gencode/gencode.v42.primary_assembly.noPar.annotation.gtf  --sjdbOverhang 75 --runThreadN 16

# Uncomment the last line to email output file to specified address.
# Slurm doesn't do this automatically, regardless of the mail-type setting above.
#/usr/bin/mail -s "$SLURM_JOB_NAME $SLURM_JOB_ID" your_username@wi.mit.edu < friendlyname-${SLURM_JOB_ID}.out

##################bsub script-gtexv8-pipeline-download-genecount 
###pipeline QA cmds
cd /lab/solexa_page/linyong/
date
df -h | grep -i page
du -sh .
grep -in error dir-gtex-*/out-*
# dir-gtex-02/out-01:23403:  [Exception type: ValueError, raised in libcalignmentfile.pyx:947]
# check if still running
ls dir-gtex-*/out-* -lh
tail dir-gtex-*/out-*

rm -f temp1
cat dir-gtex-*/out-* > temp1
cat temp1 | grep "Uniquely mapped reads" | grep "%" | wc -l
cat temp1 | grep "Uniquely mapped reads" | grep "%" | sort +5 -6g
cat temp1 | grep "Uniquely mapped reads" | grep -v "%" | sort +5 -6g | sort | uniq -d
ls dir-gtex-*/*counts_gene -lh | grep "Feb  9 18"
# -rw-r--r-- 1 linyong input    0 Feb  9 18:26 dir-gtex-01/GTEX-WFON-2226-SM-3TW8W.Aligned.sortedByCoord.out.patched.md.bam.counts_gene
head dir-gtex-*/script-gtexv8-pipeline-download-genecount
h | grep script-make-gtexv8-pipeline
# issue pipeline cmd
# disc space used
ls -lh dir-gtex-* | grep total
# total 97G

-rw-r--r-- 1 linyong input  48G Feb  9 18:52 GTEX-14BMU-1526-SM-5TDE6.Aligned.sortedByCoord.out.patched.md.bam
-rw-r--r-- 1 linyong input  61G Feb  9 21:06 r3.fq
-rw-r--r-- 1 linyong input  61G Feb  9 21:06 r4.fq
                          Number of input reads |       334353824
                      Average input read length |       152
                   Uniquely mapped reads number |       309927931
                        Uniquely mapped reads % |       92.69%


######pipeline QC cmds; version Feb 13, 2023
cd /lab/solexa_page/linyong/
date
df -h | grep -i page
du -sh . /lab/page_human_data/linyong2/
grep -in error dir-gtex-*/out-*  /lab/page_human_data/linyong2/dir-gtex-*/out-*
# dir-gtex-02/out-01:23403:  [Exception type: ValueError, raised in libcalignmentfile.pyx:947]
# dir-gtex-41/out-dir-gtex-41-Tue_Feb_14_15:21:42_EST_2023:1867:  [Exception type: ValueError, raised in libcalignmentfile.pyx:947]

# check if still running
ls dir-gtex-*/out-*  /lab/page_human_data/linyong2/dir-gtex-*/out-* -lh
tail dir-gtex-*/out-* /lab/page_human_data/linyong2/dir-gtex-*/out-*
###avoid dup directory such as out-dir-gtex-34
bjobs -w -u  linyong | grep linyong | awk '{print $10}' | sort | sed 's/-[A-Z].*//' | sort | uniq -d
# out-dir-gtex-16
# out-dir-gtex-17
# out-dir-gtex-18

ls dir-gtex-10/*counts_gene | while read f; do grep -iw ddx3y "$f"; grep -iw xist "$f"; echo; done
# ENSG00000067048.17    DDX3Y   4
# ENSG00000229807.13    XIST    14641

#MT- genes at the end of orig/downloaded bam file
grep "MT-CO1" dir-gtex-24/*counts_gene  | sort +2 -3g | wc -l
# dir-gtex-24/GTEX-P4QS-1126-SM-3NMD5.Aligned.sortedByCoord.out.patched.md.bam.counts_gene:ENSG00000198804.2    MT-CO1  3848681

rm -f temp1
cat dir-gtex-*/out-*  /lab/page_human_data/linyong2/dir-gtex-*/out-*  > temp1
cat temp1 | grep "Uniquely mapped reads" | grep "%" | wc -l
cat temp1 | grep "Uniquely mapped reads" | grep "%" | sort +5 -6g
cat temp1 | grep "Uniquely mapped reads" | grep -v "%" | sort +5 -6g | sort | uniq -d
cat temp1 | grep "Uniquely mapped reads" | grep -v "%" | sort +5 -6g | sort  | uniq | awk 'NR == 450'
###median uniq read coverage                   Uniquely mapped reads number |   37274465

ls dir-gtex-*/*counts_gene /lab/page_human_data/linyong2/dir-gtex-*/*counts_gene  -lh | grep "Feb  9 18"
# -rw-r--r-- 1 linyong input    0 Feb  9 18:26 dir-gtex-01/GTEX-WFON-2226-SM-3TW8W.Aligned.sortedByCoord.out.patched.md.bam.counts_gene
head dir-gtex-*/script-gtexv8-pipeline-download-genecount
h | grep script-make-gtexv8-pipeline
# issue pipeline cmd
# disc space used
ls -lh dir-gtex-* | grep total
# total 97G

# error message before Fri Feb 17 12:51:13 EST 2023
# dir-gtex-02/out-01:23403:  [Exception type: ValueError, raised in libcalignmentfile.pyx:947]
# dir-gtex-38/out-dir-gtex-38-Tue_Feb_14_15:14:38_EST_2023:54102:2023/02/17 06:41:20 Error occurred when checking for latest version: Get "https://api.github.com/repos/uc-cdis/cdis-data-client/tags": dial tcp 140.82.114.6:443: connect: connection refused
### for dir-gtex-38/GTEX-146FR-0526-SM-5Q5EX.Aligned.sortedByCoord.out.patched.md.bam
### 2023/02/17 06:42:54 1 files downloaded.
### -rw-r--r-- 1 linyong input 9.9G Feb 17 07:01 r3.fq
###                    Uniquely mapped reads number |       51774649
### result ok
### -rw-r--r-- 1 linyong input 1.9M Feb 17 09:29 dir-gtex-38/GTEX-146FR-0526-SM-5Q5EX.Aligned.sortedByCoord.out.patched.md.bam.counts_gene
### next bam file 2023/02/17 09:29:54 1 files downloaded.
### -rw-r--r-- 1 linyong input 1.9M Feb 17 11:59 dir-gtex-38/GTEX-17JCI-2326-SM-7IGPC.Aligned.sortedByCoord.out.patched.md.bam.counts_gene

# dir-gtex-41/out-dir-gtex-41-Tue_Feb_14_15:21:42_EST_2023:1867:  [Exception type: ValueError, raised in libcalignmentfile.pyx:947]
# /lab/page_human_data/linyong2/dir-gtex-44/out-dir-gtex-44-Wed_Feb_15_15:26:05_EST_2023:13062:  [Exception type: ValueError, raised in libcalignmentfile.pyx:947]  
### dir-gtex-44/GTEX-1GTWX-0003-SM-EYYVV.Aligned.sortedByCoord.out.patched.md.bam  files have encountered an error during downloading
### INFO    2023-02-16 15:27:08     SamToFastq

# GTEX-XGQ4-1026-SM-4AT4L.Aligned.sortedByCoord.out.patched.md.bam
###EXITING: fatal error trying to allocate genome arrays, exception thrown: std::bad_alloc
###Possible cause 1: not enough RAM. Check if you have enough RAM 31588312371 bytes
###Possible cause 2: not enough virtual memory allowed with ulimit. SOLUTION: run ulimit -v 31588312371
### -rw-r--r-- 1 linyong page_hd 6.1G Feb 19 03:02 r4.fq
### -rw-r--r-- 1 linyong page_hd    0 Feb 19 03:02 /lab/page_human_data/linyong2/dir-gtex-54/GTEX-XGQ4-1026-SM-4AT4L.Aligned.sortedByCoord.out.patched.md.bam.counts_gene

# /lab/page_human_data/linyong2/dir-gtex-62/out-dir-gtex-62-Fri_Feb_17_13:22:32_EST_2023:218:  [Exception type: ValueError, raised in libcalignmentfile.pyx:947] GTEX-18465-0526-SM-7LG4K.Aligned.sortedByCoord.out.patched.md.bam, Error occurred when getting download URL for object; INFO    2023-02-17 13:22:40     SamToFastq; next bam file , "GTEX-11OC5-0626-SM-5HL6M.Aligned.sortedByCoord.out.patched.md.bam", to be downloaded 2023/02/17 13:27:52 A new version of gen3-client is available! The latest version is 2023.2.0. You are using version 2022.12;
head ../dir-gtex-84/GTEX-1ICLZ-0726-SM-ARL84.Aligned.sortedByCoord.out.patched.md.bam.counts_gene
ENSG00000000003.15      TSPAN6  757
ENSG00000000005.6       TNMD    24
ENSG00000000419.14      DPM1    620
ENSG00000000457.14      SCYL3   440
ENSG00000000460.17      C1orf112        194
ENSG00000000938.13      FGR     273
ENSG00000000971.17      CFH     3229
ENSG00000001036.14      FUCA2   520
ENSG00000001084.13      GCLC    399
ENSG00000001167.15      NFYA    630

head ../dir-gtex-84/GTEX-XMK1-0326-SM-4B652.Aligned.sortedByCoord.out.patched.md.bam.counts_gene
ENSG00000000003.15      TSPAN6  634
ENSG00000000005.6       TNMD    0
ENSG00000000419.14      DPM1    681
ENSG00000000457.14      SCYL3   347
ENSG00000000460.17      C1orf112        66
ENSG00000000938.13      FGR     75
ENSG00000000971.17      CFH     97
ENSG00000001036.14      FUCA2   733
ENSG00000001084.13      GCLC    717
ENSG00000001167.15      NFYA    463

head dir-gtex-97/GTEX-1B933-0011-R11a-SM-7P8PM.Aligned.sortedByCoord.out.patched.md.bam.counts_gene
ENSG00000000003.15      TSPAN6  95
ENSG00000000005.6       TNMD    0
ENSG00000000419.14      DPM1    1297
ENSG00000000457.14      SCYL3   622
ENSG00000000460.17      C1orf112        141
ENSG00000000938.13      FGR     125
ENSG00000000971.17      CFH     25
ENSG00000001036.14      FUCA2   281
ENSG00000001084.13      GCLC    861
ENSG00000001167.15      NFYA    1014

tail -n 15 dir-gtex-107/GTEX-13O3P-0626-SM-5L3D5.Aligned.sortedByCoord.out.patched.md.bam.counts_gene
ENSG00000291292.1       ENSG00000291292 0
ENSG00000291293.1       ENSG00000291293 0
ENSG00000291294.1       ENSG00000291294 0
ENSG00000291295.1       ENSG00000291295 0
ENSG00000291296.1       ENSG00000291296 4
ENSG00000291297.1       ENSG00000291297 0
ENSG00000291298.1       ENSG00000291298 0
ENSG00000291299.1       ENSG00000291299 48
ENSG00000291300.1       PRSS30P 0
ENSG00000291301.1       ENSG00000291301 0
__no_feature            2245732
__ambiguous             4096397
__too_low_aQual         0
__not_aligned           731747
__alignment_not_unique          1859550

dir-gtex-118/GTEX-ZAB5-2426-SM-5CVMW.Aligned.sortedByCoord.out.patched.md.bam.counts_gene <==
ENSG00000000003.15      TSPAN6  1901
ENSG00000000005.6       TNMD    2
ENSG00000000419.14      DPM1    1456
ENSG00000000457.14      SCYL3   443
ENSG00000000460.17      C1orf112        437
ENSG00000000938.13      FGR     144
ENSG00000000971.17      CFH     147
ENSG00000001036.14      FUCA2   223
ENSG00000001084.13      GCLC    574
ENSG00000001167.15      NFYA    2663

#######################################################################################################
###### Mar 2, 2023 gene count table for 1st 3k samples
rm -f dir-list
ls  /lab/solexa_page/linyong/ | grep dir-gtex- | awk '{print "/lab/solexa_page/linyong/" $0}' > dir-list
ls /lab/page_human_data/linyong2/ | grep "dir-gtex-[0-7][0-9]\/" | awk '{print "/lab/page_human_data/linyong2/" $0}' >> dir-list
wc -l dir-list
# 79 dir-list
bash  /lab/solexa_page/linyong/script-genecount-merge-2
ls  /lab/solexa_page/linyong/temp-gtexv8-* | wc -l
# 3127
cd /lab/solexa_page/linyong/
rm -f temp1
bsub "bash script-paste-files"
ls -lh m s
# -rw-r--r-- 1 linyong input 490M (3127 samples) Mar  2 19:21 s
grep -n '__no_feature' s | cut -f 1-10
# 62705:__no_feature
awk 'NR < 62705' s > temp1
# mv -i  temp1 gtex-comb-3127samp.gene.count.txt
awk '{print NF}' gtex-comb-3127samp.gene.count.txt | uniq -c | head
#  62704 3129
awk '{print NF}' s | uniq -c | head
#  62704 3129
#      5 3128 (lack gene_name column)
rm -f s

mkdir dir-gtex-141
cd dir-gtex-141
cp -i ../dir-gtex-131/slurm-gtexv8-pipeline-download-genecount .
grep -Ei "file_name|error"  ../dir-gtex-131/out-dir-gtex-131-Thu_16_Mar_2023_07\:50\:40_PM_EDT  | awk '{print NR, $0}'

grep -w chrM  /lab/solexa_page/linyong/gencode/gencode.v42.primary_assembly.noPar.annotation.gtf | grep -w gene  | sort +3 -4gr
# PEER with covariates
echo "PEER with known covariates included in inference. Output in peer_our_covs/"
./peertool -f data/expression.csv -c data/covs.csv -n 20 -i 100 -o peer_out_covs


linyong@fry /lab/page_human_data/linyong2/test-dir$ samtools view  GTEX-ZP4G-0002-SM-6WBSI.cram | head
[W::cram_populate_ref] Creating reference cache directory /home/linyong/.cache/hts-ref
This may become large; see the samtools(1) manual page REF_CACHE discussion
H032JALXX140919:1:2207:24517:7181	1189	chr1	9996	0	*	=	9996	0	TGCCGTGCTTACTCCGCCCAACACCGCAACCACGCACCCCCCCCCCCCCACCCCCCACCCCACAAACCCCACACACCCACCAAACCCCCCACACCCCCCCCCCACACACACACAACACCCACACCACACAACAACACACAACACCAGCCAA	#######################################################################################################################################################	MC:Z:45S106M	PG:Z:MarkDuplicates	OQ:Z:#######################################################################################################################################################	RG:Z:H032J.1

linyongmao@Linyong-Mao-MBP16-2019 dir-GTExV8 % cat MGB_100.gtex-orig.counts | wc -l
   57604
cat MGB_100.gtex-orig.counts | cut -f 1,3,5 > temp1
> setwd("/Users/linyongmao/Documents/dir-GTExV8")
t1 <- read.delim("temp1", row.names=1)
rawCount <- t1
group <- factor(rep(1, 2))
y <- DGEList(counts=rawCount,group=group)
y <- calcNormFactors(y)
#           group lib.size norm.factors
#count.gtex     1 30359242    1.0070915
#MGB_100        1 30791351    0.9929585
# 30359242 / 30791351 = 0.9859665
keep <-rowSums(cpm(y)>=1) >= 1
y<-y[keep,]
dim(y)
# [1] 11778     2
design <- model.matrix(~c("gtex", "mg"))
# error  No residual df
df <- as.data.frame( cpm(y))
> m <- lm( log10(df$MGB_100 + 1) ~ log10(df$count.gtex + 1) )
> summary(m)

Call:
lm(formula = log10(df$MGB_100 + 1) ~ log10(df$count.gtex + 1))

Residuals:
     Min       1Q   Median       3Q      Max 
-1.96619 -0.05109 -0.01576  0.01960  2.49084 

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)              0.110140   0.004036   27.29   <2e-16 ***
log10(df$count.gtex + 1) 0.931960   0.002700  345.15   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.192 on 11776 degrees of freedom
Multiple R-squared:   0.91,	Adjusted R-squared:   0.91 
F-statistic: 1.191e+05 on 1 and 11776 DF,  p-value: < 2.2e-16

linyongmao@Linyong-Mao-MBP16-2019 dir-GTExV8 % cat ../microglia/HALLMARK_INFLAMMATORY_RESPONSE.temp.genes | while read g
do
grep  " $g      "  MGB_100.gtex-orig.counts
done > temp2
cat temp2 | wc -l
     200
cat temp2 | awk '$3 == $5' | wc -l
      82
cat temp2 | awk '$3 != $5' | awk '{print $0 "\t" $5/$3}' | sort +5 -6g
geneID	name	count.gtex	geneID	MGB_100

ENSG00000136634	IL10	1621	ENSG00000136634	191	0.117829
ENSG00000105835	NAMPT	161214	ENSG00000105835	85591	0.530915
ENSG00000160223	ICOSLG	28	ENSG00000160223	16	0.571429
ENSG00000101017	CD40	877	ENSG00000101017	509	0.580388
ENSG00000109320	NFKB1	1717	ENSG00000109320	1471	0.856727
ENSG00000177272	KCNA3	357	ENSG00000177272	306	0.857143
ENSG00000080815	PSEN1	2402	ENSG00000080815	2097	0.873022
ENSG00000196352	CD55	39632	ENSG00000196352	35701	0.900812
ENSG00000163251	FZD5	741	ENSG00000163251	680	0.917679
ENSG00000137462	TLR2	49892	ENSG00000137462	46511	0.932234
ENSG00000125347	IRF1	16177	ENSG00000125347	15223	0.941027
ENSG00000175591	P2RY2	198	ENSG00000175591	187	0.944444
ENSG00000103313	MEFV	2301	ENSG00000103313	2181	0.947849
ENSG00000119535	CSF3R	65724	ENSG00000119535	63554	0.966983
ENSG00000136867	SLC31A2	430	ENSG00000136867	416	0.967442
ENSG00000185885	IFITM1	407	ENSG00000185885	395	0.970516
ENSG00000054523	KIF1B	3795	ENSG00000054523	3685	0.971014
ENSG00000142166	IFNAR1	4331	ENSG00000142166	4224	0.975294
ENSG00000197405	C5AR1	29213	ENSG00000197405	28578	0.978263
ENSG00000157227	MMP14	879	ENSG00000157227	864	0.982935
ENSG00000136244	IL6	654	ENSG00000136244	646	0.987768
ENSG00000169429	CXCL8	159116	ENSG00000169429	157368	0.989014
ENSG00000115009	CCL20	2666	ENSG00000115009	2640	0.990248
ENSG00000110324	IL10RA	8973	ENSG00000110324	8892	0.990973
ENSG00000100906	NFKBIA	72042	ENSG00000100906	71421	0.99138
ENSG00000159128	IFNGR2	10443	ENSG00000159128	10362	0.992244
ENSG00000167207	NOD2	11985	ENSG00000167207	11898	0.992741
ENSG00000060558	GNA15	2537	ENSG00000060558	2520	0.993299
ENSG00000100385	IL2RB	170	ENSG00000100385	169	0.994118
ENSG00000187764	SEMA4D	2386	ENSG00000187764	2372	0.994132
ENSG00000070961	ATP2B1	6385	ENSG00000070961	6361	0.996241
ENSG00000019169	MARCO	3951	ENSG00000019169	3938	0.99671
ENSG00000099985	OSM	34374	ENSG00000099985	34280	0.997265
ENSG00000162493	PDPN	467	ENSG00000162493	466	0.997859
ENSG00000077238	IL4R	3617	ENSG00000077238	3610	0.998065
ENSG00000043462	LCP2	48979	ENSG00000043462	48901	0.998407
ENSG00000174437	ATP2A2	1295	ENSG00000174437	1293	0.998456
ENSG00000163421	PROK2	17667	ENSG00000163421	17644	0.998698
ENSG00000185507	IRF7	810	ENSG00000185507	809	0.998765
ENSG00000142227	EMP3	2475	ENSG00000142227	2472	0.998788
ENSG00000159388	BTG2	114719	ENSG00000159388	114585	0.998832
ENSG00000110911	SLC11A2	879	ENSG00000110911	878	0.998862
ENSG00000184588	PDE4B	10684	ENSG00000184588	10672	0.998877
ENSG00000106546	AHR	1787	ENSG00000106546	1785	0.998881
ENSG00000126262	FFAR2	7445	ENSG00000126262	7437	0.998925
ENSG00000085117	CD82	6040	ENSG00000085117	6034	0.999007
ENSG00000106366	SERPINE1	1059	ENSG00000106366	1058	0.999056
ENSG00000028137	TNFRSF1B	14024	ENSG00000028137	14012	0.999144
ENSG00000171522	PTGER4	5910	ENSG00000171522	5905	0.999154
ENSG00000177105	RHOG	4320	ENSG00000177105	4317	0.999306
ENSG00000115594	IL1R1	1462	ENSG00000115594	1461	0.999316
ENSG00000108688	CCL7	1483	ENSG00000108688	1482	0.999326
ENSG00000132334	PTPRE	26749	ENSG00000132334	26731	0.999327
ENSG00000121797	CCRL2	4789	ENSG00000121797	4786	0.999374
ENSG00000067082	KLF6	64070	ENSG00000067082	64033	0.999423
ENSG00000134470	IL15RA	1907	ENSG00000134470	1906	0.999476
ENSG00000011422	PLAUR	34886	ENSG00000011422	34868	0.999484
ENSG00000130303	BST2	2276	ENSG00000130303	2275	0.999561
ENSG00000131979	GCH1	4609	ENSG00000131979	4607	0.999566
ENSG00000167995	BEST1	2848	ENSG00000167995	2847	0.999649
ENSG00000123610	TNFAIP6	2953	ENSG00000123610	2952	0.999661
ENSG00000090104	RGS1	9073	ENSG00000090104	9070	0.999669
ENSG00000173391	OLR1	9401	ENSG00000173391	9398	0.999681
ENSG00000055332	EIF2AK2	3153	ENSG00000055332	3152	0.999683
ENSG00000113070	HBEGF	19847	ENSG00000113070	19841	0.999698
ENSG00000169403	PTAFR	7301	ENSG00000169403	7299	0.999726
ENSG00000125538	IL1B	109046	ENSG00000125538	109017	0.999734
ENSG00000108691	CCL2	14478	ENSG00000108691	14475	0.999793
ENSG00000010327	STAB1	5178	ENSG00000010327	5177	0.999807
ENSG00000038945	MSR1	6574	ENSG00000038945	6573	0.999848
ENSG00000165168	CYBB	13244	ENSG00000165168	13242	0.999849
ENSG00000170458	CD14	40572	ENSG00000170458	40567	0.999877
ENSG00000188404	SELL	18160	ENSG00000188404	18158	0.99989
ENSG00000102265	TIMP1	24905	ENSG00000102265	24903	0.99992
ENSG00000171051	FPR1	35289	ENSG00000171051	35291	1.00006
ENSG00000059728	MXD1	27615	ENSG00000059728	27619	1.00014
ENSG00000124762	CDKN1A	43669	ENSG00000124762	43677	1.00018
ENSG00000184371	CSF1	4722	ENSG00000184371	4723	1.00021
ENSG00000136754	ABI1	8227	ENSG00000136754	8229	1.00024
ENSG00000124882	EREG	6708	ENSG00000124882	6710	1.0003
ENSG00000169508	GPR183	16071	ENSG00000169508	16076	1.00031
ENSG00000141506	PIK3R5	11983	ENSG00000141506	11988	1.00042
ENSG00000258227	CLEC5A	2258	ENSG00000258227	2259	1.00044
ENSG00000090339	ICAM1	20197	ENSG00000090339	20206	1.00045
ENSG00000137393	RNF144B	5743	ENSG00000137393	5746	1.00052
ENSG00000078401	EDN1	1700	ENSG00000078401	1701	1.00059
ENSG00000073008	PVR	1676	ENSG00000073008	1677	1.0006
ENSG00000139514	SLC7A1	1308	ENSG00000139514	1309	1.00076
ENSG00000135124	P2RX4	2431	ENSG00000135124	2433	1.00082
ENSG00000125384	PTGER2	7900	ENSG00000125384	7911	1.00139
ENSG00000115008	IL1A	575	ENSG00000115008	576	1.00174
ENSG00000174600	CMKLR1	558	ENSG00000174600	559	1.00179
ENSG00000049249	TNFRSF9	554	ENSG00000049249	555	1.00181
ENSG00000164136	IL15	490	ENSG00000164136	491	1.00204
ENSG00000161638	ITGA5	2377	ENSG00000161638	2382	1.0021
ENSG00000254087	LYN	13961	ENSG00000254087	13992	1.00222
ENSG00000148926	ADM	6856	ENSG00000148926	6880	1.0035
ENSG00000198121	LPAR1	1704	ENSG00000198121	1710	1.00352
ENSG00000104312	RIPK2	6503	ENSG00000104312	6526	1.00354
ENSG00000171596	NMUR1	262	ENSG00000171596	263	1.00382
ENSG00000103569	AQP9	9587	ENSG00000103569	9628	1.00428
ENSG00000131871	SELENOS	853	ENSG00000131871	857	1.00469
ENSG00000017260	ATP2C1	1108	ENSG00000017260	1114	1.00542
ENSG00000117091	CD48	1686	ENSG00000117091	1703	1.01008
ENSG00000170425	ADORA2B	76	ENSG00000170425	77	1.01316
ENSG00000175040	CHST2	530	ENSG00000175040	539	1.01698
ENSG00000089041	P2RX7	2101	ENSG00000089041	2137	1.01713
ENSG00000173039	RELA	3131	ENSG00000173039	3203	1.023
ENSG00000164023	SGMS2	911	ENSG00000164023	954	1.0472
ENSG00000065135	GNAI3	5256	ENSG00000065135	6072	1.15525
ENSG00000136997	MYC	1945	ENSG00000136997	2347	1.20668
ENSG00000122641	INHBA	161	ENSG00000122641	200	1.24224
ENSG00000100644	HIF1A	11259	ENSG00000100644	14210	1.2621
ENSG00000121989	ACVR2A	161	ENSG00000121989	216	1.34161
ENSG00000172575	RASGRP1	249	ENSG00000172575	389	1.56225
ENSG00000132155	RAF1	5473	ENSG00000132155	8798	1.60753
ENSG00000231925	TAPBP	6543	ENSG00000231925	11503	1.75806
ENSG00000162711	NLRP3	1562	ENSG00000162711	12689	8.12356

cat temp2 | awk '$3 == $5 && $3 > 0'  | sort +2 -3g
ENSG00000064989	CALCRL	2	ENSG00000064989	2
ENSG00000110436	SLC1A2	2	ENSG00000110436	2
ENSG00000105855	ITGB8	3	ENSG00000105855	3
ENSG00000124875	CXCL6	6	ENSG00000124875	6
ENSG00000057019	DCBLD2	11	ENSG00000057019	11
ENSG00000115604	IL18R1	21	ENSG00000115604	21
ENSG00000105246	EBI3	23	ENSG00000105246	23
ENSG00000169245	CXCL10	25	ENSG00000169245	25
ENSG00000105711	SCN1B	58	ENSG00000105711	58
ENSG00000164342	TLR3	68	ENSG00000164342	68
ENSG00000196639	HRH1	103	ENSG00000196639	103
ENSG00000172215	CXCR6	117	ENSG00000172215	117
ENSG00000160013	PTGIR	122	ENSG00000160013	122
ENSG00000134070	IRAK2	126	ENSG00000134070	126
ENSG00000074660	SCARF1	173	ENSG00000074660	173
ENSG00000168685	IL7R	181	ENSG00000168685	181
ENSG00000117090	SLAMF1	206	ENSG00000117090	206
ENSG00000146242	TPBG	222	ENSG00000146242	222
ENSG00000167601	AXL	227	ENSG00000167601	227
ENSG00000102962	CCL22	269	ENSG00000102962	269
ENSG00000123700	KCNJ2	287	ENSG00000123700	287
ENSG00000271503	CCL5	289	ENSG00000271503	289
ENSG00000135503	ACVR1B	405	ENSG00000135503	405
ENSG00000145623	OSMR	478	ENSG00000145623	478
ENSG00000204681	GABBR1	484	ENSG00000204681	484
ENSG00000150782	IL18	524	ENSG00000150782	524
ENSG00000115607	IL18RAP	560	ENSG00000115607	560
ENSG00000130706	ADRM1	641	ENSG00000130706	641
ENSG00000125657	TNFSF9	935	ENSG00000125657	935
ENSG00000128342	LIF	1058	ENSG00000128342	1058
ENSG00000174837	ADGRE1	1164	ENSG00000174837	1164
ENSG00000143333	RGS16	1338	ENSG00000143333	1338
ENSG00000160932	LY6E	1527	ENSG00000160932	1527
ENSG00000136868	SLC31A1	1904	ENSG00000136868	1904
ENSG00000075142	SRI	1969	ENSG00000075142	1969
ENSG00000123609	NMI	2047	ENSG00000123609	2047
ENSG00000165029	ABCA1	2666	ENSG00000165029	2666
ENSG00000130164	LDLR	2980	ENSG00000130164	2980
ENSG00000183484	GPR132	2982	ENSG00000183484	2982
ENSG00000176170	SPHK1	3753	ENSG00000176170	3753
ENSG00000121858	TNFSF10	4348	ENSG00000121858	4348
ENSG00000171860	C3AR1	7615	ENSG00000171860	7615
ENSG00000110848	CD69	7968	ENSG00000110848	7968
ENSG00000174125	TLR1	9152	ENSG00000174125	9152

chr1    HAVANA  exon    247423847       247425599       .       +       .       gene_id "ENSG00000162711.18"; transcript_id "ENST00000697350.1"; gene_type "protein_coding"; gene_name "NLRP3"; transcript_type "protein_coding"; transcript_name "NLRP3-210"; exon_number 4; exon_id "ENSE00001067929.1"; level 2; protein_id "ENSP00000513275.1"; hgnc_id "HGNC:16400"; tag "alternative_5_UTR"; tag "upstream_ATG"; tag "RNA_Seq_supported_only"; tag "basic"; tag "appris_principal_1"; havana_gene "OTTHUMG00000040647.7";

chr1    HAVANA  exon    247423847       247425599       .       +       .       gene_id "ENSG00000289728.1"; transcript_id "ENST00000697408.1"; gene_type "lncRNA"; gene_name "ENSG00000289728"; transcript_type "lncRNA"; transcript_name "ENST00000697408"; exon_number 7; exon_id "ENSE00003970522.1"; level 2; tag "RNA_Seq_supported_only"; tag "basic"; tag "Ensembl_canonical"; tag "readthrough_transcript";

cat /lab/solexa_page/linyong/Homo_sapiens.GRCh38.90.gtf| grep "24742[0-9][0-9][0-9][0-9]"  | awk '$1 == 1'  | grep -v NLRP3 | wc -l
0

for d in  `echo "dir-gtex-433 dir-gtex-436 dir-gtex-437 dir-gtex-438 dir-gtex-439" `
do
 tail -n 1 $d/out*
 cd  $d
 rm -f [GL]*
 sbatch slurm-gtexv8-pipeline-download-genecount 
 cd ..
 sleep 30
done

#####################################check stuck then rerun results
cd ../dir-gtex-433
ls -lh *counts_gene | sort  +5 -6 +6 -7g +7 -8 | awk '{print $7}' | uniq -c
ls -lh *counts_gene | sort  +5 -6 +6 -7g +7 -8
ls *counts_gene | while read f; do grep -iw ddx3y "$f"; grep -iw xist "$f"; echo; done

scontrol show job | grep linyong | grep StdOut | grep -o "dir-gtex-[0-9]*" | sort | uniq | while read d
do
echo $d
cat $d/out* | tail
echo
done

#########################merge gene count files; combine
ls  /lab/solexa_page/linyong/ | grep "^dir-gtex-[0-9]*/"  | awk '{print "/lab/solexa_page/linyong/" $0}' > dir-list
ls /lab/page_human_data/linyong2/ | grep "^dir-gtex-[0-9]*/" | awk '{print "/lab/page_human_data/linyong2/" $0}' >> dir-list
wc -l dir-list*
cat dir-list* | sort | uniq -d | wc -l
cat dir-list* | sort | uniq -u | wc -l
cat dir-list* | sort | uniq -u > temp
mv temp dir-list
###rm dir-gtex-462 from dir-list because dir-gtex-462 is still running
bash  /lab/solexa_page/linyong/script-genecount-merge-2
cat  /lab/solexa_page/linyong/temp-error | grep -v "cannot access" |head
ls  /lab/solexa_page/linyong/temp-gtexv8-* | wc -l
# 6402
cd /lab/solexa_page/linyong/
rm -f temp1
bsub "bash script-paste-files"
# 8 hour running on LSF
ls -lh s  f2 m
grep -n '__no_feature' s | cut -f 1-10
# 62705:__no_feature            1875341 3762916 3548239 3767337 2554672 3159592 2963935 2526148
awk 'NR < 62705' s > temp1
mv -i temp1 gtex-comb-6402samp.gene.count.txt
chmod -w gtex-comb-6402samp.gene.count.txt
awk '{print NF}' gtex-comb-6402samp.gene.count.txt | uniq -c | head
#  62704 6404
rm -f s

##########################################################
-r--r--r-- 1 linyong systemd-timesync  513411552 Mar  2 22:21 gtex-comb-3127samp.gene.count.txt
-r--r--r-- 1 linyong systemd-timesync  719148199 Mar 27 11:39 gtex-comb-4388samp.gene.count.txt
-r--r--r-- 1 linyong systemd-timesync 1048559353 Apr 27 23:40 gtex-comb-6402samp.gene.count.txt
-r--r--r-- 1 linyong input 380514586 May 27 01:44 gtex-comb-2317samp.gene.count.txt

################################################select 10 random samples within top half
linyongmao@Linyong-Mao-MBP16-2019 dir-gtex-website-data % cat  GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct | awk '{print NF}' | uniq -c
   1 1
   1 2
56201 17384
awk 'NR > 2'  GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct  > temp
mv temp  GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct 
head -1 GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct  | awk 'BEGIN {FS = "\t"; OFS = "\t"} {for(i = 1; i <= NF; i++) print i, $i}' > GTEx_Analysis_2017-06-05_header
cut -f 1,7    GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt > sample-tissue.2colum
cut -f 2 sample-tissue.2colum | sort | uniq -c | wc
      56 
cat   GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt | cut -f 7,17 | sort | uniq -c   
 432 Heart - Left Ventricle	RNASEQ
 429 Heart - Atrial Appendage	RNASEQ
 803 Muscle - Skeletal	RNASEQ

> setwd("/Users/linyongmao/Documents/dir-GTExV8/dir-gtex-website-data")
t1 <- read.delim("sample-tissue.2colum", header=F)
t2 <- t1[ t1$V2 == "Heart - Left Ventricle", ]
t3 <- read.delim("GTEx_Analysis_2017-06-05_header", header=F)
head(t3)
#  V1                       V2
#1  1                     Name
#2  2              Description
#3  3 GTEX-1117F-0226-SM-5GZZ7

t4 <- merge(t3, t2, by.x="V2", by.y="V1")
dim(t4)
# [1] 432   3
head(t4)
#                         V2  V1                   V2.y
# 1 GTEX-111FC-0826-SM-5GZWO  40 Heart - Left Ventricle
# 2 GTEX-111YS-0426-SM-5987O  65 Heart - Left Ventricle
raw <- read.delim("GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct", header=T)
dim(raw)
###[1] 56200genes  17384
raw2 <- raw[, t4$V1 ]
rownames(raw2) <- raw$Name
y <- DGEList(counts=raw2)
y <- calcNormFactors(y)
med <- data.frame(y$counts[,1])
med$logic <- TRUE
d <- cpm(y)
for(i in 1:dim(y)[1]) {
 med$logic[i] <- median(d[i,]) >= 1
}
####median >= 1 for pathway genes
y<-y[med$logic,]
dim(y)
# [1] 13615   432
d = cpm(y)
t9 <- as.data.frame(d)
t10 <- log10(t9 + 1)
t11 <- cor(t10)
t12 <- as.data.frame(t11)
mat <- as.matrix(t12)
res <- data.frame(id = colnames(mat), mean = colMeans(mat))
summary( res$mean)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#  0.7060  0.8903  0.9091  0.8977  0.9158  0.9291 
med <- median(res$mean)
r2 <- res[ res$mean > med, ]
dim(r2)
##[1] 216   2
set.seed(1234)
r3 <- r2[ sample(1:dim(r2)[1], 10 ), ]
write.table(r3, "Heart - Left Ventricle.10.samples", quote=F, sep='\t')

#########################merge gene count files; combine; May 25, 2023
cd /lab/page_human_data/linyong2/
from prev commands
vi dir-list
/lab/page_human_data/linyong2/dir-gtex-462/
/lab/page_human_data/linyong2/dir-gtex-487/
/lab/page_human_data/linyong2/dir-gtex-488/
/lab/page_human_data/linyong2/dir-gtex-489/
/lab/page_human_data/linyong2/dir-gtex-490/
...
/lab/page_human_data/linyong2/dir-gtex-601/
2317 samples

################################# order-bam.notProcessed
cat /lab/solexa_page/linyong/file-manifest.json  | grep "Aligned.sortedByCoord.out.patched.md.bam" | awk 'BEGIN {FS = "\t"; OFS = "\t"} {print NR, $1}' > temp1
vi temp1
linyong@fry /lab/solexa_page/linyong$ tail temp1
...
17348   GTEX-1HCVE-1026-SM-ACKXR.Aligned.sortedByCoord.out.patched.md.bam
17349   GTEX-1GN2E-1526-SM-7P8TD.Aligned.sortedByCoord.out.patched.md.bam
17350   GTEX-17JCI-1526-SM-7IGOQ.Aligned.sortedByCoord.out.patched.md.bam
mv temp1 file-manifest.order-bam.txt
 head -1 *samp.gene.count.txt | grep -w "geneID"  |cut -f 3-1234567 | awk 'BEGIN {FS = "\t"; OFS = "\t"} {for(i = 1; i <= NF; i++) print  $i}' > temp2
wc -l temp2
16234 temp2
> 2317 + 3127 + 4388 + 6402
[1] 16234
head temp2
GTEX-1117F-0526-SM-5EGHJ.
GTEX-1117F-2826-SM-5GZXL.
GTEX-111CU-0626-SM-5EGHL.
cat temp2  | while read g; do grep  "$g"Aligned file-manifest.order-bam.txt; done > temp3
cat file-manifest.order-bam.txt temp3 | sort | uniq -d | wc
  16234
cat file-manifest.order-bam.txt temp3 | sort | uniq -u | wc
   1116
cat file-manifest.order-bam.txt temp3 | sort | uniq -u > file-manifest.order-bam.notProcess.5.27.23
head /lab/solexa_page/linyong/file-manifest.order-bam.notProcess.5.27.23  
10068   GTEX-146FR-1826-SM-5QGPF.Aligned.sortedByCoord.out.patched.md.bam
10069   GTEX-13RTJ-0726-SM-5QGQN.Aligned.sortedByCoord.out.patched.md.bam
10070   GTEX-15RIE-0626-SM-6M47G.Aligned.sortedByCoord.out.patched.md.bam
